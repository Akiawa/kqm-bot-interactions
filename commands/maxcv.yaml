description: Calculate the max CV an artifact can roll based on its current substats.

interaction:
  embeds:
    - title: Crit Value Calculator
      description: >-
         <$js
            const critValues = new Set([
              0.0,  5.4,  6.2, 7.0, 
              7.8, 10.8, 11.6, 12.4, 
              13.2, 14.0, 14.8, 15.6, 
              18.6, 19.4, 20.2, 21.0, 
              21.8, 22.6, 23.4, 26.4, 
              27.2, 28.0, 28.8, 29.6, 
              30.4, 31.2, 34.2, 35.0, 
              35.8, 36.6, 37.4, 38.2, 
              39.0, 42.0, 42.8, 43.6, 
              44.4, 45.2, 46.0, 46.8, 
              49.8, 50.6, 51.4, 52.2, 
              53.0, 53.8, 54.6
            ]);
            
            function execute() {
             const currentLevel = $OPTIONS.CURRENTLEVEL;
             const currentCV = $OPTIONS.CURRENTCD + $OPTIONS.CURRENTCR * 2;

             if (currentLevel < 0 || currentLevel > 20){
                return 'Please enter a valid artifact level. Levels should be between 0 to 20.';
             }
          
             if (!critValues.has(currentCV)) {
                return 'You have entered an invalid crit value.';
             }
        
             let rolls = (20 - currentLevel + currentLevel % 4) / 4;
        
             if (currentCV > 54.6 - rolls * 7.8){
                return 'Your crit value is too high for the current aritfact level.';
             }

             if (!currentCV && (!$OPTIONS.THREELINER || currentLevel >= 4)){
                return [ 'You seriously put that in a CV calculator???\n', 'Current Level: ' + currentLevel,'Current CV: ' + currentCV,'Maximum CV: ' + 0 ].join('\n');
             }
          
             if ($OPTIONS.THREELINER && currentLevel < 4 && currentCV > 7.8)
                rolls -= 1;
          
             const maxCV = currentCV + rolls * 7.8;
                return [ 'Current Level: ' + currentLevel,'Current CV: ' + currentCV,'Maximum CV: ' + maxCV ].join('\n');
             }
      
            execute();
          $>

options:
  currentcd: 
    required: true 
    description: Current Artifact Crit Dmg
    type: number
    
  currentcr: 
    required: true 
    description: Current Artifact Crit Rate
    type: number

  currentlevel: 
    required: true 
    description: Current Artifact Level
    type: number
    
  threeliner: 
    required: false 
    description: Did the artifact start with 3 lines?
    type: boolean
